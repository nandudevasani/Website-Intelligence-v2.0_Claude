<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Website Intelligence ‚Äî Domain Analyzer</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{--bg-primary:#0a0e17;--bg-secondary:#111827;--bg-card:#151d2e;--bg-card-hover:#1a2540;--border:#1e2a42;--border-glow:#2563eb33;--text-primary:#e8edf5;--text-secondary:#8896b0;--text-muted:#4a5875;--accent:#3b82f6;--accent-glow:#3b82f640;--green:#22c55e;--green-bg:#22c55e15;--red:#ef4444;--red-bg:#ef444415;--orange:#f59e0b;--orange-bg:#f59e0b15;--yellow:#eab308;--yellow-bg:#eab30815;--purple:#a855f7;--purple-bg:#a855f715;--cyan:#06b6d4;--cyan-bg:#06b6d415;--blue:#3b82f6;--blue-bg:#3b82f615}
    html{scroll-behavior:smooth}
    body{font-family:'DM Sans',system-ui,sans-serif;background:var(--bg-primary);color:var(--text-primary);min-height:100vh;line-height:1.6}
    .bg-grid{position:fixed;inset:0;background-image:linear-gradient(rgba(59,130,246,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(59,130,246,.03) 1px,transparent 1px);background-size:60px 60px;pointer-events:none;z-index:0}
    .bg-glow{position:fixed;top:-200px;left:50%;transform:translateX(-50%);width:800px;height:600px;background:radial-gradient(ellipse,rgba(59,130,246,.08),transparent 70%);pointer-events:none;z-index:0}
    .container{position:relative;z-index:1;max-width:1100px;margin:0 auto;padding:2rem 1.5rem 4rem}
    .header{text-align:center;padding:3rem 0 2.5rem}
    .header-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:var(--bg-card);border:1px solid var(--border);border-radius:100px;font-size:.75rem;font-weight:600;color:var(--accent);letter-spacing:.08em;text-transform:uppercase;margin-bottom:1.25rem}
    .header-badge .dot{width:6px;height:6px;border-radius:50%;background:var(--green);animation:pulse-dot 2s infinite}
    @keyframes pulse-dot{0%,100%{opacity:1}50%{opacity:.4}}
    .header h1{font-family:'JetBrains Mono',monospace;font-size:2.2rem;font-weight:700;letter-spacing:-.03em;margin-bottom:.5rem;background:linear-gradient(135deg,#e8edf5,#8896b0);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .header p{color:var(--text-secondary);font-size:1rem;max-width:520px;margin:0 auto}
    .search-section{display:flex;gap:10px;margin-bottom:2rem;max-width:700px;margin-left:auto;margin-right:auto}
    .search-input-wrap{flex:1;position:relative}
    .search-input-wrap .icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:var(--text-muted);pointer-events:none}
    .search-input{width:100%;padding:14px 16px 14px 46px;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;color:var(--text-primary);font-size:1rem;font-family:'JetBrains Mono',monospace;outline:none;transition:border-color .2s,box-shadow .2s}
    .search-input::placeholder{color:var(--text-muted)}
    .search-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-glow)}
    .btn{padding:14px 28px;background:var(--accent);border:none;border-radius:12px;color:#fff;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap;font-family:'DM Sans',sans-serif}
    .btn:hover{background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 20px var(--accent-glow)}
    .btn:active{transform:translateY(0)}.btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
    .btn-csv{padding:10px 20px;background:var(--green);border:none;border-radius:10px;color:#fff;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:'DM Sans',sans-serif;display:inline-flex;align-items:center;gap:6px}
    .btn-csv:hover{background:#16a34a;transform:translateY(-1px);box-shadow:0 4px 16px rgba(34,197,94,.3)}
    .tabs{display:flex;gap:4px;margin-bottom:2rem;max-width:700px;margin-left:auto;margin-right:auto;background:var(--bg-secondary);border-radius:10px;padding:4px}
    .tab{flex:1;padding:10px;background:none;border:none;border-radius:8px;color:var(--text-secondary);font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:'DM Sans',sans-serif}
    .tab:hover{color:var(--text-primary)}.tab.active{background:var(--bg-card);color:var(--text-primary);box-shadow:0 1px 4px rgba(0,0,0,.2)}
    .bulk-input{display:none;max-width:700px;margin:0 auto 2rem}.bulk-input.visible{display:block}
    .bulk-textarea{width:100%;height:180px;padding:14px 16px;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;color:var(--text-primary);font-family:'JetBrains Mono',monospace;font-size:.9rem;outline:none;resize:vertical;transition:border-color .2s,box-shadow .2s;margin-bottom:6px}
    .bulk-textarea::placeholder{color:var(--text-muted)}.bulk-textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px var(--accent-glow)}
    .bulk-count{font-size:.8rem;color:var(--text-muted);margin-bottom:10px;font-family:'JetBrains Mono',monospace}
    .loader{display:none;text-align:center;padding:3rem}.loader.visible{display:block}
    .spinner{width:44px;height:44px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite;margin:0 auto 1rem}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loader-text{color:var(--text-secondary);font-size:.9rem}
    .loader-domain{font-family:'JetBrains Mono',monospace;color:var(--accent);font-weight:600}
    .progress-bar-wrap{max-width:400px;margin:1rem auto 0;background:var(--bg-secondary);border-radius:8px;height:8px;overflow:hidden}
    .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--green));border-radius:8px;transition:width .3s ease;width:0%}
    .progress-text{font-size:.8rem;color:var(--text-muted);margin-top:6px;font-family:'JetBrains Mono',monospace}
    .results{display:none}.results.visible{display:block}
    .status-hero{background:var(--bg-card);border:1px solid var(--border);border-radius:16px;padding:2rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1.5rem;position:relative;overflow:hidden}
    .status-hero::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
    .status-hero[data-color="green"]::before{background:linear-gradient(90deg,var(--green),#10b981)}
    .status-hero[data-color="red"]::before{background:linear-gradient(90deg,var(--red),#dc2626)}
    .status-hero[data-color="orange"]::before{background:linear-gradient(90deg,var(--orange),#d97706)}
    .status-hero[data-color="yellow"]::before{background:linear-gradient(90deg,var(--yellow),#ca8a04)}
    .status-hero[data-color="blue"]::before{background:linear-gradient(90deg,var(--blue),#2563eb)}
    .status-icon{width:64px;height:64px;border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:1.8rem;flex-shrink:0}
    .status-icon.green{background:var(--green-bg)}.status-icon.red{background:var(--red-bg)}.status-icon.orange{background:var(--orange-bg)}.status-icon.yellow{background:var(--yellow-bg)}.status-icon.blue{background:var(--blue-bg)}
    .status-info{flex:1}
    .status-domain{font-family:'JetBrains Mono',monospace;font-size:1.25rem;font-weight:700;margin-bottom:4px}
    .status-label{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:100px;font-size:.78rem;font-weight:700;letter-spacing:.06em;text-transform:uppercase}
    .status-label.green{background:var(--green-bg);color:var(--green)}.status-label.red{background:var(--red-bg);color:var(--red)}.status-label.orange{background:var(--orange-bg);color:var(--orange)}.status-label.yellow{background:var(--yellow-bg);color:var(--yellow)}.status-label.blue{background:var(--blue-bg);color:var(--blue)}
    .status-reason{color:var(--text-secondary);font-size:.9rem;margin-top:6px}
    .status-meta{text-align:right;flex-shrink:0}
    .status-meta-item{font-size:.8rem;color:var(--text-muted);margin-bottom:4px}
    .status-meta-item span{color:var(--text-secondary);font-family:'JetBrains Mono',monospace;font-weight:500}
    .cards-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1rem;margin-bottom:1.5rem}
    .card{background:var(--bg-card);border:1px solid var(--border);border-radius:14px;padding:1.5rem;transition:border-color .2s}.card:hover{border-color:var(--border-glow)}
    .card-header{display:flex;align-items:center;gap:10px;margin-bottom:1.25rem}
    .card-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
    .card-icon.blue{background:var(--blue-bg)}.card-icon.green{background:var(--green-bg)}.card-icon.purple{background:var(--purple-bg)}.card-icon.cyan{background:var(--cyan-bg)}.card-icon.orange{background:var(--orange-bg)}
    .card-title{font-weight:600;font-size:.95rem}
    .info-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)}.info-row:last-child{border-bottom:none}
    .info-label{font-size:.82rem;color:var(--text-muted);font-weight:500}
    .info-value{font-family:'JetBrains Mono',monospace;font-size:.85rem;font-weight:500;text-align:right;max-width:60%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .info-value.green{color:var(--green)}.info-value.red{color:var(--red)}.info-value.orange{color:var(--orange)}
    .content-card{grid-column:1/-1}
    .content-verdict{display:flex;align-items:center;gap:10px;padding:12px 16px;border-radius:10px;margin-bottom:1rem;font-weight:600;font-size:.92rem}
    .content-verdict.green{background:var(--green-bg);color:var(--green)}.content-verdict.red{background:var(--red-bg);color:var(--red)}.content-verdict.orange{background:var(--orange-bg);color:var(--orange)}.content-verdict.yellow{background:var(--yellow-bg);color:var(--yellow)}.content-verdict.blue{background:var(--blue-bg);color:var(--blue)}
    .content-confidence{margin-left:auto;font-size:.8rem;opacity:.8}
    .content-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px}
    .content-stat{background:var(--bg-secondary);border-radius:8px;padding:10px;text-align:center}
    .content-stat-value{font-family:'JetBrains Mono',monospace;font-size:1.1rem;font-weight:700;color:var(--text-primary)}
    .content-stat-label{font-size:.7rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.04em;margin-top:2px}
    .redirect-box{background:var(--red-bg);border:1px solid rgba(239,68,68,.2);border-radius:10px;padding:14px;margin-bottom:1rem}
    .redirect-box-title{font-size:.85rem;font-weight:700;color:var(--red);margin-bottom:8px}
    .redirect-box-detail{font-size:.82rem;color:var(--text-secondary);padding:3px 0}.redirect-box-detail span{font-family:'JetBrains Mono',monospace;color:var(--text-primary)}
    .flag-badge{display:inline-block;padding:3px 10px;border-radius:6px;font-size:.72rem;font-weight:700;font-family:'JetBrains Mono',monospace;letter-spacing:.04em;margin:2px 4px 2px 0;background:var(--bg-secondary);color:var(--text-muted)}
    .flag-badge.warn{background:var(--red-bg);color:var(--red)}.flag-badge.info{background:var(--blue-bg);color:var(--blue)}
    .bulk-results{display:none}.bulk-results.visible{display:block}
    .bulk-summary{display:flex;gap:1rem;margin-bottom:1rem;flex-wrap:wrap}
    .bulk-summary-item{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:1rem 1.5rem;text-align:center;flex:1;min-width:120px}
    .bulk-summary-value{font-family:'JetBrains Mono',monospace;font-size:1.5rem;font-weight:700}
    .bulk-summary-label{font-size:.75rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.05em;margin-top:2px}
    .bulk-actions{display:flex;justify-content:flex-end;margin-bottom:1rem;gap:10px}
    .bulk-table-wrap{overflow-x:auto;border-radius:12px;border:1px solid var(--border)}
    .bulk-table{width:100%;border-collapse:collapse;font-size:.85rem}
    .bulk-table thead{background:var(--bg-secondary)}
    .bulk-table th{padding:12px 14px;text-align:left;font-size:.75rem;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:.06em;border-bottom:1px solid var(--border);white-space:nowrap}
    .bulk-table td{padding:10px 14px;border-bottom:1px solid var(--border);vertical-align:top}.bulk-table tr:last-child td{border-bottom:none}.bulk-table tr:hover{background:var(--bg-card-hover)}
    .bulk-domain{font-family:'JetBrains Mono',monospace;font-weight:600;font-size:.82rem}
    .bulk-status-badge{display:inline-block;padding:3px 10px;border-radius:6px;font-size:.72rem;font-weight:700;letter-spacing:.04em;white-space:nowrap}
    .bulk-status-badge.ACTIVE{background:var(--green-bg);color:var(--green)}
    .bulk-status-badge.DEAD,.bulk-status-badge.DOWN,.bulk-status-badge.SUSPENDED{background:var(--red-bg);color:var(--red)}
    .bulk-status-badge.PARKED,.bulk-status-badge.NO_CONTENT,.bulk-status-badge.DEFAULT_PAGE,.bulk-status-badge.SHELL_SITE{background:var(--orange-bg);color:var(--orange)}
    .bulk-status-badge.COMING_SOON,.bulk-status-badge.ISSUES{background:var(--yellow-bg);color:var(--yellow)}
    .bulk-status-badge.CROSS_DOMAIN_REDIRECT{background:var(--red-bg);color:var(--red)}
    .bulk-status-badge.POLITICAL_CAMPAIGN{background:var(--blue-bg);color:var(--blue)}
    .bulk-status-badge.ERROR{background:var(--red-bg);color:var(--red)}
    .bulk-valid{font-weight:700;font-size:.82rem}.bulk-valid.yes{color:var(--green)}.bulk-valid.no{color:var(--red)}
    .error-box{display:none;background:var(--red-bg);border:1px solid rgba(239,68,68,.3);border-radius:12px;padding:1.25rem 1.5rem;margin-bottom:1.5rem;color:var(--red);font-weight:500}.error-box.visible{display:block}
    @media(max-width:640px){.header h1{font-size:1.5rem}.search-section{flex-direction:column}.status-hero{flex-direction:column;text-align:center}.status-meta{text-align:center}.cards-grid{grid-template-columns:1fr}.content-stats{grid-template-columns:repeat(2,1fr)}.bulk-table{font-size:.78rem}.bulk-table th,.bulk-table td{padding:8px 10px}}
  </style>
</head>
<body>
  <div class="bg-grid"></div><div class="bg-glow"></div>
  <div class="container">
    <header class="header">
      <div class="header-badge"><span class="dot"></span> Intelligence Engine v2.3</div>
      <h1>Website Intelligence</h1>
      <p>Detect parked domains, shell sites, cross-domain redirects, coming soon pages, political campaigns & more.</p>
    </header>
    <div class="tabs">
      <button class="tab active" data-tab="single" onclick="switchTab('single')">Single Domain</button>
      <button class="tab" data-tab="bulk" onclick="switchTab('bulk')">Bulk Analysis</button>
    </div>
    <div class="search-section" id="single-search">
      <div class="search-input-wrap">
        <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" class="search-input" id="domain-input" placeholder="Enter domain (e.g. example.com)" autocomplete="off" spellcheck="false">
      </div>
      <button class="btn" id="analyze-btn" onclick="analyzeDomain()">Analyze</button>
    </div>
    <div class="bulk-input" id="bulk-section">
      <textarea class="bulk-textarea" id="bulk-input-ta" placeholder="Enter domains, one per line (max 100):&#10;example.com&#10;google.com&#10;test.com" oninput="updateCount()"></textarea>
      <div class="bulk-count" id="bulk-count">0 domains entered (max 100)</div>
      <button class="btn" id="bulk-btn" onclick="analyzeBulk()" style="width:100%">Analyze All</button>
    </div>
    <div class="error-box" id="error-box"></div>
    <div class="loader" id="loader"><div class="spinner"></div><div class="loader-text">Analyzing <span class="loader-domain" id="loader-domain">...</span></div><div class="loader-text" style="margin-top:4px;font-size:.8rem;color:var(--text-muted)">Checking DNS, SSL, HTTP & content intelligence...</div><div class="progress-bar-wrap" id="progress-wrap" style="display:none"><div class="progress-bar" id="progress-bar"></div></div><div class="progress-text" id="progress-text" style="display:none"></div></div>
    <div class="results" id="results">
      <div class="status-hero" id="status-hero" data-color="green">
        <div class="status-icon green" id="status-icon">‚úì</div>
        <div class="status-info"><div class="status-domain" id="result-domain">example.com</div><span class="status-label green" id="status-label">ACTIVE</span><div class="status-reason" id="status-reason"></div></div>
        <div class="status-meta"><div class="status-meta-item">Response <span id="meta-response">‚Äî</span></div><div class="status-meta-item">HTTP <span id="meta-http">‚Äî</span></div><div class="status-meta-item">SSL <span id="meta-ssl">‚Äî</span></div></div>
      </div>
      <div class="cards-grid">
        <div class="card"><div class="card-header"><div class="card-icon blue">‚ö°</div><div class="card-title">HTTP Status</div></div><div id="http-details"></div></div>
        <div class="card"><div class="card-header"><div class="card-icon green">üîí</div><div class="card-title">SSL Certificate</div></div><div id="ssl-details"></div></div>
        <div class="card"><div class="card-header"><div class="card-icon purple">üåê</div><div class="card-title">DNS Records</div></div><div id="dns-details"></div></div>
        <div class="card"><div class="card-header"><div class="card-icon cyan">üñ•</div><div class="card-title">Server Info</div></div><div id="server-details"></div></div>
        <div class="card content-card"><div class="card-header"><div class="card-icon orange">üìä</div><div class="card-title">Content Intelligence</div></div><div id="content-details"></div></div>
      </div>
    </div>
    <div class="bulk-results" id="bulk-results"></div>
  </div>
<script>
const API=window.location.origin;let lastBulkResults=null;
function switchTab(t){document.querySelectorAll('.tab').forEach(e=>e.classList.remove('active'));document.querySelector('[data-tab="'+t+'"]').classList.add('active');document.getElementById('single-search').style.display=t==='single'?'flex':'none';document.getElementById('bulk-section').classList.toggle('visible',t==='bulk');document.getElementById('results').classList.remove('visible');document.getElementById('bulk-results').classList.remove('visible');document.getElementById('error-box').classList.remove('visible')}
function updateCount(){const t=document.getElementById('bulk-input-ta').value.trim();const c=t?t.split('\n').filter(d=>d.trim().length>0).length:0;const e=document.getElementById('bulk-count');e.textContent=c+' domain'+(c!==1?'s':'')+' entered (max 100)';e.style.color=c>100?'var(--red)':'var(--text-muted)'}
document.getElementById('domain-input').addEventListener('keydown',e=>{if(e.key==='Enter')analyzeDomain()});
async function analyzeDomain(){const d=document.getElementById('domain-input').value.trim();if(!d)return;showLoader(d);hideAll();try{const r=await fetch(API+'/api/analyze',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({domain:d})});if(!r.ok)throw new Error('Failed');renderResults(await r.json())}catch(e){showError('Failed: '+e.message)}finally{hideLoader()}}
function renderResults(d){document.getElementById('results').classList.add('visible');const c=d.statusColor||'gray';document.getElementById('status-hero').setAttribute('data-color',c);const icon=document.getElementById('status-icon');icon.className='status-icon '+c;icon.textContent=statusEmoji(d.overallStatus);document.getElementById('result-domain').textContent=d.domain;const lbl=document.getElementById('status-label');lbl.className='status-label '+c;lbl.textContent=fmtStatus(d.overallStatus);document.getElementById('status-reason').textContent=d.content?.reasons?.[0]||'';document.getElementById('meta-response').textContent=d.http?.responseTime?d.http.responseTime+'ms':'‚Äî';document.getElementById('meta-http').textContent=d.http?.statusCode||'‚Äî';document.getElementById('meta-ssl').textContent=d.ssl?.valid?'‚úì Valid':'‚úó Invalid';
document.getElementById('http-details').innerHTML=rows([['Status Code',d.http?.statusCode?d.http.statusCode+' '+(d.http.statusText||''):'N/A',d.http?.statusCode>=200&&d.http?.statusCode<400?'green':'red'],['Response Time',d.http?.responseTime?d.http.responseTime+'ms':'N/A',d.http?.responseTime<1000?'green':d.http?.responseTime<3000?'orange':'red'],['Final URL',trunc(d.http?.finalUrl||'N/A',40)],['Is Up',d.http?.isUp?'Yes':'No',d.http?.isUp?'green':'red']]);
const ssl=d.ssl||{};document.getElementById('ssl-details').innerHTML=rows([['Valid',ssl.valid?'Yes':'No',ssl.valid?'green':'red'],['Issuer',ssl.issuer||'N/A'],['Subject',ssl.subject||'N/A'],['Days Left',ssl.daysRemaining!=null?ssl.daysRemaining+' days':'N/A',ssl.daysRemaining>30?'green':ssl.daysRemaining>0?'orange':'red'],['Protocol',ssl.protocol||'N/A']]);
const dns=d.dns||{};document.getElementById('dns-details').innerHTML=rows([['A Records',dns.aRecords?.length>0?dns.aRecords.join(', '):'None',dns.hasARecord?'green':'red'],['MX Records',dns.mxRecords?.length>0?dns.mxRecords.map(m=>m.exchange).join(', '):'None'],['NS Records',dns.nsRecords?.length>0?dns.nsRecords.slice(0,3).join(', '):'None'],['CNAME',dns.cnameRecords?.length>0?dns.cnameRecords.join(', '):'None']]);
document.getElementById('server-details').innerHTML=rows([['Server',d.http?.headers?.server||'Not disclosed'],['Powered By',d.http?.headers?.poweredBy||'Not disclosed'],['Content-Type',d.http?.headers?.contentType||'N/A']]);
const ct=d.content||{};const vc=verdictColor(ct.verdict);let h='<div class="content-verdict '+vc+'"><span style="font-size:1.2rem">'+verdictEmoji(ct.verdict)+'</span><span>'+fmtVerdict(ct.verdict)+'</span><span class="content-confidence">'+(ct.confidence||0)+'% confidence</span></div>';
if(ct.reasons?.length>0)h+='<div style="color:var(--text-secondary);font-size:.85rem;margin-bottom:1rem">'+ct.reasons.map(r=>'‚Ä¢ '+esc(r)).join('<br>')+'</div>';
if(ct.redirectInfo){h+='<div class="redirect-box"><div class="redirect-box-title">‚ö† Cross-Domain Redirect Detected</div><div class="redirect-box-detail">Source: <span>'+esc(ct.redirectInfo.source)+'</span></div><div class="redirect-box-detail">Target: <span>'+esc(ct.redirectInfo.target)+'</span></div><div class="redirect-box-detail">Target Domain: <span>'+esc(ct.redirectInfo.targetDomain)+'</span></div><div class="redirect-box-detail">Method: <span>'+esc(ct.redirectInfo.method)+'</span></div></div>'}
h+='<div class="content-stats" style="margin-top:1rem">';h+=stat(ct.details?.wordCount||0,'Words')+stat(ct.details?.uniqueWordCount||0,'Unique')+stat(ct.details?.headings?.length||0,'Headings')+stat(ct.details?.images||0,'Images')+stat(ct.details?.links?.internal||0,'Int Links')+stat(ct.details?.links?.external||0,'Ext Links')+stat(ct.details?.forms||0,'Forms')+'</div>';
if(ct.details?.title){h+='<div style="margin-top:1rem;padding:10px 14px;background:var(--bg-secondary);border-radius:8px"><span style="font-size:.75rem;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:.05em">Page Title</span><br><span style="font-family:\'JetBrains Mono\',monospace;font-size:.85rem">'+esc(ct.details.title)+'</span></div>'}
if(ct.flags?.length>0){h+='<div style="margin-top:10px">';ct.flags.forEach(f=>{const w=['CROSS_DOMAIN_REDIRECT','SUSPICIOUS_REDIRECT_TARGET','SHELL_SITE','PARKED'].includes(f);const i=['POLITICAL_CAMPAIGN','HAS_FEC_DISCLOSURE','WEB_APP_LOGIN'].includes(f);h+='<span class="flag-badge '+(w?'warn':i?'info':'')+'">'+f.replace(/_/g,' ')+'</span>'});h+='</div>'}
document.getElementById('content-details').innerHTML=h}

// === BULK ANALYSIS ‚Äî Sequential with Progress ===
async function analyzeBulk(){const txt=document.getElementById('bulk-input-ta').value.trim();if(!txt)return;const doms=txt.split('\n').map(d=>d.trim()).filter(d=>d.length>0);if(doms.length===0)return;if(doms.length>100){showError('Maximum 100 domains. You entered '+doms.length+'.');return}
hideAll();showLoader('0 / '+doms.length+' domains');showProgress(0,doms.length);const results=[];const btn=document.getElementById('bulk-btn');btn.disabled=true;
for(let i=0;i<doms.length;i++){updateProgress(i,doms.length,doms[i]);try{const r=await fetch(API+'/api/analyze',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({domain:doms[i]})});if(!r.ok)throw new Error('HTTP '+r.status);const data=await r.json();results.push({domain:data.domain,overallStatus:data.overallStatus,isGenuinelyValid:data.isGenuinelyValid,statusCode:data.http?.statusCode,confidence:data.content?.confidence,reasons:data.content?.reasons||[],flags:data.content?.flags||[],redirectInfo:data.content?.redirectInfo,title:data.content?.details?.title,wordCount:data.content?.details?.wordCount,uniqueWordCount:data.content?.details?.uniqueWordCount})}catch(e){results.push({domain:doms[i],overallStatus:'ERROR',isGenuinelyValid:false,error:e.message,reasons:[e.message],flags:[]})}}
btn.disabled=false;hideLoader();lastBulkResults=results;renderBulk({results})}
function showProgress(c,t){document.getElementById('progress-wrap').style.display='block';document.getElementById('progress-text').style.display='block';updateProgress(c,t,'')}
function updateProgress(c,t,d){const p=t>0?Math.round((c/t)*100):0;document.getElementById('progress-bar').style.width=p+'%';document.getElementById('progress-text').textContent=c+' / '+t+' completed'+(d?' ‚Äî scanning '+d:'');document.getElementById('loader-domain').textContent=c+' / '+t+' domains'}
function renderBulk(data){const el=document.getElementById('bulk-results');el.classList.add('visible');const res=data.results||[];const active=res.filter(r=>r.isGenuinelyValid).length;const invalid=res.filter(r=>!r.isGenuinelyValid&&r.overallStatus!=='ERROR').length;const errs=res.filter(r=>r.overallStatus==='ERROR').length;
let h='<div class="bulk-summary">'+sumItem(res.length,'Total','--text-primary')+sumItem(active,'Valid','--green')+sumItem(invalid,'Invalid','--orange')+sumItem(errs,'Errors','--red')+'</div>';
h+='<div class="bulk-actions"><button class="btn-csv" onclick="exportCSV()">‚¨á Export CSV</button></div>';
h+='<div class="bulk-table-wrap"><table class="bulk-table"><thead><tr><th>#</th><th>Domain</th><th>Status</th><th>Valid?</th><th>Confidence</th><th>Redirect Target</th><th>Flags</th><th>Remarks / Reason</th></tr></thead><tbody>';
res.forEach((r,i)=>{const redir=r.redirectInfo?r.redirectInfo.target:'‚Äî';const flags=r.flags?.length>0?r.flags.join(', '):'‚Äî';const reason=r.reasons?.[0]||r.error||'‚Äî';
h+='<tr><td style="font-family:\'JetBrains Mono\',monospace;font-size:.78rem;color:var(--text-muted)">'+(i+1)+'</td><td><span class="bulk-domain">'+esc(r.domain)+'</span></td><td><span class="bulk-status-badge '+r.overallStatus+'">'+fmtStatus(r.overallStatus)+'</span></td><td><span class="bulk-valid '+(r.isGenuinelyValid?'yes':'no')+'">'+(r.isGenuinelyValid?'‚úì YES':'‚úó NO')+'</span></td><td style="font-family:\'JetBrains Mono\',monospace;font-size:.82rem">'+(r.confidence?r.confidence+'%':'‚Äî')+'</td><td style="font-family:\'JetBrains Mono\',monospace;font-size:.78rem;max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+esc(redir)+'</td><td style="font-size:.78rem;max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'+esc(flags)+'</td><td style="color:var(--text-secondary);font-size:.8rem;max-width:250px">'+esc(reason.substring(0,120))+'</td></tr>'});
h+='</tbody></table></div>';el.innerHTML=h}

// === CSV EXPORT ===
function exportCSV(){if(!lastBulkResults||lastBulkResults.length===0){showError('No results to export');return}
const headers=['Domain','Status','Valid','Confidence','Redirect Target','Flags','Remarks'];const csvRows=lastBulkResults.map(r=>[r.domain||'',fmtStatus(r.overallStatus)||'',r.isGenuinelyValid?'TRUE':'FALSE',r.confidence?r.confidence+'%':'',r.redirectInfo?r.redirectInfo.target:'',(r.flags||[]).join('; '),(r.reasons?.[0]||r.error||'').replace(/"/g,"'")]);
let csv=headers.map(h=>'"'+h+'"').join(',')+'\n';csvRows.forEach(row=>{csv+=row.map(cell=>'"'+String(cell).replace(/"/g,'""')+'"').join(',')+'\n'});
const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='website-intelligence-'+new Date().toISOString().split('T')[0]+'.csv';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url)}

// === HELPERS ===
function rows(arr){return arr.map(([l,v,c])=>'<div class="info-row"><span class="info-label">'+l+'</span><span class="info-value'+(c?' '+c:'')+'">'+esc(String(v))+'</span></div>').join('')}
function stat(v,l){return '<div class="content-stat"><div class="content-stat-value">'+v+'</div><div class="content-stat-label">'+l+'</div></div>'}
function sumItem(v,l,c){return '<div class="bulk-summary-item"><div class="bulk-summary-value" style="color:var('+c+')">'+v+'</div><div class="bulk-summary-label">'+l+'</div></div>'}
function showLoader(t){document.getElementById('loader-domain').textContent=t;document.getElementById('loader').classList.add('visible')}
function hideLoader(){document.getElementById('loader').classList.remove('visible');document.getElementById('progress-wrap').style.display='none';document.getElementById('progress-text').style.display='none'}
function hideAll(){document.getElementById('results').classList.remove('visible');document.getElementById('bulk-results').classList.remove('visible');document.getElementById('error-box').classList.remove('visible')}
function showError(m){const e=document.getElementById('error-box');e.textContent=m;e.classList.add('visible')}
function trunc(s,n){return s.length>n?s.substring(0,n)+'‚Ä¶':s}
function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}
function statusEmoji(s){return{ACTIVE:'‚úì',DEAD:'‚úó',DOWN:'‚úó',PARKED:'‚äò',COMING_SOON:'‚óî',NO_CONTENT:'‚óã',REDIRECT_HOST:'‚§≥',DEFAULT_PAGE:'‚ñ§',SUSPENDED:'‚äò',SHELL_SITE:'‚óá',CROSS_DOMAIN_REDIRECT:'‚ÜØ',POLITICAL_CAMPAIGN:'‚òÖ',ISSUES:'!',UNKNOWN:'?'}[s]||'?'}
function fmtStatus(s){return{ACTIVE:'Active',DEAD:'Dead',DOWN:'Down',PARKED:'Parked / For Sale',COMING_SOON:'Coming Soon',NO_CONTENT:'No Content',REDIRECT_HOST:'Host Redirect',DEFAULT_PAGE:'Default Page',SUSPENDED:'Suspended',SHELL_SITE:'Shell Site',CROSS_DOMAIN_REDIRECT:'Cross-Domain Redirect',POLITICAL_CAMPAIGN:'Political Campaign',ISSUES:'Issues',ERROR:'Error',UNKNOWN:'Unknown'}[s]||s}
function fmtVerdict(v){return{VALID:'Genuine Active Website',PARKED:'Parked Domain / For Sale',COMING_SOON:'Coming Soon / Under Construction',NO_CONTENT:'No Meaningful Content',REDIRECT_HOST:'Redirects to Hosting Provider',DEFAULT_PAGE:'Default Server Page',SUSPENDED:'Account Suspended',SHELL_SITE:'Template Shell ‚Äî No Real Content',CROSS_DOMAIN_REDIRECT:'Redirects to Unrelated Domain',POLITICAL_CAMPAIGN:'Political Campaign Site'}[v]||v}
function verdictColor(v){return{VALID:'green',PARKED:'orange',COMING_SOON:'yellow',NO_CONTENT:'orange',REDIRECT_HOST:'orange',DEFAULT_PAGE:'orange',SUSPENDED:'red',SHELL_SITE:'orange',CROSS_DOMAIN_REDIRECT:'red',POLITICAL_CAMPAIGN:'blue'}[v]||'orange'}
function verdictEmoji(v){return{VALID:'‚úÖ',PARKED:'üÖøÔ∏è',COMING_SOON:'üöß',NO_CONTENT:'üì≠',REDIRECT_HOST:'‚Ü™Ô∏è',DEFAULT_PAGE:'üìÑ',SUSPENDED:'üö´',SHELL_SITE:'üèóÔ∏è',CROSS_DOMAIN_REDIRECT:'‚ö†Ô∏è',POLITICAL_CAMPAIGN:'üèõÔ∏è'}[v]||'‚ùì'}
</script>
</body>
</html>
